{"version":3,"sources":["../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../src/actions/upload.ts","../../../../src/actions/products.ts","../../../../.next-internal/server/app/admin/%28dashboard%29/products/%5Bid%5D/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","'use server';\r\n\r\nimport { writeFile, mkdir } from 'fs/promises';\r\nimport { join } from 'path';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nexport async function uploadImage(formData: FormData) {\r\n    const file = formData.get('file') as File;\r\n    if (!file) {\r\n        throw new Error('Dosya seçilmedi');\r\n    }\r\n\r\n    const bytes = await file.arrayBuffer();\r\n    const buffer = Buffer.from(bytes);\r\n\r\n    // Allow only images\r\n    if (!file.type.startsWith('image/')) {\r\n        throw new Error('Sadece resim dosyaları yüklenebilir');\r\n    }\r\n\r\n    const uniqueSuffix = uuidv4();\r\n    const originalName = file.name.replace(/\\.[^/.]+$/, \"\").replace(/[^a-z0-9]/gi, '_').toLowerCase();\r\n    const ext = file.name.split('.').pop();\r\n    const filename = `${originalName}-${uniqueSuffix}.${ext}`;\r\n\r\n    const uploadDir = join(process.cwd(), 'public', 'uploads');\r\n\r\n    // Ensure directory exists\r\n    try {\r\n        await mkdir(uploadDir, { recursive: true });\r\n    } catch (e) {\r\n        // ignore\r\n    }\r\n\r\n    const filepath = join(uploadDir, filename);\r\n    await writeFile(filepath, buffer);\r\n\r\n    return `/uploads/${filename}`;\r\n}\r\n","'use server';\r\n\r\nimport { db } from '@/lib/json-db';\r\nimport { Product } from '@/types';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { revalidatePath } from 'next/cache';\r\nimport { redirect } from 'next/navigation';\r\n\r\nexport async function createProduct(formData: FormData) {\r\n    const title = formData.get('title') as string;\r\n    const price = Number(formData.get('price'));\r\n    const stock = Number(formData.get('stock'));\r\n    const description = formData.get('description') as string;\r\n    const isActive = formData.get('isActive') === 'on';\r\n\r\n    // Process images\r\n    const imagesJson = formData.get('images') as string; // JSON string from client\r\n    const images = JSON.parse(imagesJson || '[]') as string[];\r\n    const image = images[0] || ''; // Set first image as featured\r\n\r\n    const slug = title\r\n        .toLowerCase()\r\n        .replace(/[^a-z0-9]+/g, '-')\r\n        .replace(/(^-|-$)/g, '');\r\n\r\n    const newProduct: Product = {\r\n        id: uuidv4(),\r\n        title,\r\n        slug,\r\n        price,\r\n        stock,\r\n        description,\r\n        image,\r\n        images,\r\n        isActive,\r\n    };\r\n\r\n    const products = await db.products.getAll();\r\n    products.push(newProduct);\r\n    await db.products.updateAll(products);\r\n\r\n    revalidatePath('/urunler');\r\n    revalidatePath('/admin/products');\r\n    return { success: true };\r\n}\r\n\r\nexport async function updateProduct(id: string, formData: FormData) {\r\n    const title = formData.get('title') as string;\r\n    const price = Number(formData.get('price'));\r\n    const stock = Number(formData.get('stock'));\r\n    const description = formData.get('description') as string;\r\n    const isActive = formData.get('isActive') === 'on';\r\n\r\n    // Process images\r\n    const imagesJson = formData.get('images') as string;\r\n    const images = JSON.parse(imagesJson || '[]') as string[];\r\n    const image = images[0] || '';\r\n\r\n    const products = await db.products.getAll();\r\n    const index = products.findIndex((p) => p.id === id);\r\n\r\n    if (index === -1) throw new Error('Ürün bulunamadı');\r\n\r\n    products[index] = {\r\n        ...products[index],\r\n        title,\r\n        price,\r\n        stock,\r\n        description,\r\n        image,\r\n        images,\r\n        isActive,\r\n    };\r\n\r\n    await db.products.updateAll(products);\r\n\r\n    revalidatePath('/urunler');\r\n    revalidatePath(`/urunler/${products[index].slug}`);\r\n    revalidatePath('/admin/products');\r\n    return { success: true };\r\n}\r\n\r\nexport async function deleteProduct(id: string) {\r\n    let products = await db.products.getAll();\r\n    products = products.filter((p) => p.id !== id);\r\n    await db.products.updateAll(products);\r\n\r\n    revalidatePath('/urunler');\r\n    revalidatePath('/admin/products');\r\n}\r\n","export {logout as '0045e9b9d28bc56362bae83ded660aa300f0f050e3'} from 'ACTIONS_MODULE0'\nexport {createProduct as '40bb89a2d76cc84c1cc6e414690912a504149a50f0'} from 'ACTIONS_MODULE1'\nexport {updateProduct as '60899f959fba04a8735acceb673007bde5f31ad751'} from 'ACTIONS_MODULE1'\nexport {uploadImage as '40f282f1b7f6ba2f9131f89b460fc154dd7302e6d3'} from 'ACTIONS_MODULE2'\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"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","ignoreList":[0,1]}