{"version":3,"sources":["../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../src/actions/upload.ts","../../../../.next-internal/server/app/admin/%28dashboard%29/gallery/page/actions.js%20%28server%20actions%20loader%29","../../../../src/actions/gallery.ts"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","'use server';\r\n\r\nimport { writeFile, mkdir } from 'fs/promises';\r\nimport { join } from 'path';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nexport async function uploadImage(formData: FormData) {\r\n    const file = formData.get('file') as File;\r\n    if (!file) {\r\n        throw new Error('Dosya seçilmedi');\r\n    }\r\n\r\n    const bytes = await file.arrayBuffer();\r\n    const buffer = Buffer.from(bytes);\r\n\r\n    // Allow only images\r\n    if (!file.type.startsWith('image/')) {\r\n        throw new Error('Sadece resim dosyaları yüklenebilir');\r\n    }\r\n\r\n    const uniqueSuffix = uuidv4();\r\n    const originalName = file.name.replace(/\\.[^/.]+$/, \"\").replace(/[^a-z0-9]/gi, '_').toLowerCase();\r\n    const ext = file.name.split('.').pop();\r\n    const filename = `${originalName}-${uniqueSuffix}.${ext}`;\r\n\r\n    const uploadDir = join(process.cwd(), 'public', 'uploads');\r\n\r\n    // Ensure directory exists\r\n    try {\r\n        await mkdir(uploadDir, { recursive: true });\r\n    } catch (e) {\r\n        // ignore\r\n    }\r\n\r\n    const filepath = join(uploadDir, filename);\r\n    await writeFile(filepath, buffer);\r\n\r\n    return `/uploads/${filename}`;\r\n}\r\n","export {logout as '0045e9b9d28bc56362bae83ded660aa300f0f050e3'} from 'ACTIONS_MODULE0'\nexport {uploadImage as '40f282f1b7f6ba2f9131f89b460fc154dd7302e6d3'} from 'ACTIONS_MODULE1'\nexport {addGalleryItem as '4051f45c74dd1fd142cf39bdc40491b5940b26dd68'} from 'ACTIONS_MODULE2'\nexport {deleteGalleryItem as '4007614a188d548d0f21e076502b008d5f0b51d1f5'} from 'ACTIONS_MODULE2'\n","'use server';\r\n\r\nimport { db } from '@/lib/json-db';\r\nimport { GalleryItem } from '@/types';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport async function addGalleryItem(formData: FormData) {\r\n    const fileUrl = formData.get('image') as string;\r\n    const title = formData.get('title') as string;\r\n    const category = formData.get('category') as string;\r\n\r\n    if (!fileUrl) throw new Error('Resim yüklenmedi');\r\n\r\n    const newItem: GalleryItem = {\r\n        id: uuidv4(),\r\n        src: fileUrl,\r\n        title,\r\n        category\r\n    };\r\n\r\n    const gallery = await db.gallery.getAll();\r\n    gallery.push(newItem);\r\n    await db.gallery.updateAll(gallery);\r\n\r\n    revalidatePath('/admin/gallery');\r\n}\r\n\r\nexport async function deleteGalleryItem(id: string) {\r\n    let gallery = await db.gallery.getAll();\r\n    gallery = gallery.filter(i => i.id !== id);\r\n    await db.gallery.updateAll(gallery);\r\n    revalidatePath('/admin/gallery');\r\n}\r\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"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","ignoreList":[0,1]}