{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/savas/Downloads/agenttest/EylulSanatWeb/src/actions/auth.ts"],"sourcesContent":["'use server';\r\n\r\nimport bcrypt from 'bcryptjs';\r\nimport { createSession, deleteSession } from '@/lib/session';\r\nimport { redirect } from 'next/navigation';\r\nimport { db } from '@/lib/json-db';\r\n\r\nexport async function login(formData: FormData) {\r\n    const password = formData.get('password') as string;\r\n    const settings = await db.settings.get();\r\n    const storedHash = settings.adminPasswordHash || process.env.ADMIN_PASSWORD_HASH;\r\n\r\n    if (!storedHash) {\r\n        throw new Error('Admin password hash is not set');\r\n    }\r\n\r\n    // Development bypass ensures you can login locally easily\r\n    // In production, this block is automatically skipped\r\n    if (process.env.NODE_ENV !== 'production' && password === 'admin123') {\r\n        await createSession();\r\n        redirect('/admin');\r\n    }\r\n\r\n    const isValid = await bcrypt.compare(password, storedHash);\r\n\r\n    if (!isValid) {\r\n        return { error: 'Hatalı şifre.' };\r\n    }\r\n\r\n    await createSession();\r\n    redirect('/admin');\r\n}\r\n\r\nexport async function logout() {\r\n    await deleteSession();\r\n    redirect('/');\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAAA;AACA;;;;;;;AAEO,eAAe,MAAM,QAAkB;IAC1C,MAAM,WAAW,SAAS,GAAG,CAAC;IAC9B,MAAM,WAAW,MAAM,8HAAE,CAAC,QAAQ,CAAC,GAAG;IACtC,MAAM,aAAa,SAAS,iBAAiB,IAAI,QAAQ,GAAG,CAAC,mBAAmB;IAEhF,IAAI,CAAC,YAAY;QACb,MAAM,IAAI,MAAM;IACpB;IAEA,0DAA0D;IAC1D,qDAAqD;IACrD,IAAI,oDAAyB,gBAAgB,aAAa,YAAY;QAClE,MAAM,IAAA,sIAAa;QACnB,IAAA,iMAAQ,EAAC;IACb;IAEA,MAAM,UAAU,MAAM,4IAAM,CAAC,OAAO,CAAC,UAAU;IAE/C,IAAI,CAAC,SAAS;QACV,OAAO;YAAE,OAAO;QAAgB;IACpC;IAEA,MAAM,IAAA,sIAAa;IACnB,IAAA,iMAAQ,EAAC;AACb;AAEO,eAAe;IAClB,MAAM,IAAA,sIAAa;IACnB,IAAA,iMAAQ,EAAC;AACb;;;IA7BsB;IA0BA;;AA1BA,+OAAA;AA0BA,+OAAA"}},
    {"offset": {"line": 137, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/savas/Downloads/agenttest/EylulSanatWeb/src/actions/messages.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db } from '@/lib/json-db';\r\nimport { Message } from '@/types';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nimport nodemailer from 'nodemailer';\r\n\r\nexport async function sendMessage(formData: FormData) {\r\n    const settings = await db.settings.get();\r\n    const name = formData.get('name') as string;\r\n    const email = formData.get('email') as string || 'Belirtilmedi';\r\n    const phone = formData.get('phone') as string || 'Belirtilmedi';\r\n    const messageContent = formData.get('message') as string;\r\n\r\n    if (!name || !messageContent) {\r\n        throw new Error('Lütfen zorunlu alanları doldurun (Ad ve Mesaj).');\r\n    }\r\n\r\n    const newMessage: Message = {\r\n        id: uuidv4(),\r\n        name,\r\n        email,\r\n        phone,\r\n        message: messageContent,\r\n        createdAt: new Date().toISOString(),\r\n        isRead: false\r\n    };\r\n\r\n    await db.messages.add(newMessage);\r\n\r\n    // E-posta Gönderimi (Opsiyonel SMTP Ayarları ile)\r\n    try {\r\n        const transporter = nodemailer.createTransport({\r\n            host: process.env.SMTP_HOST,\r\n            port: Number(process.env.SMTP_PORT),\r\n            secure: process.env.SMTP_PORT === '465',\r\n            auth: {\r\n                user: process.env.SMTP_USER,\r\n                pass: process.env.SMTP_PASS,\r\n            },\r\n        });\r\n\r\n        const mailOptions = {\r\n            from: process.env.SMTP_USER,\r\n            to: settings.contact.email, // Ayarlardaki e-posta adresine gönder\r\n            subject: `Yeni Mesaj: ${name}`,\r\n            text: `\r\n                Yeni bir iletişim formu mesajınız var:\r\n                \r\n                Ad Soyad: ${name}\r\n                E-posta: ${email}\r\n                Telefon: ${phone}\r\n                Mesaj: ${messageContent}\r\n                 Tarih: ${new Date().toLocaleDateString('tr-TR')}\r\n            `,\r\n        };\r\n\r\n        if (process.env.SMTP_HOST) {\r\n            await transporter.sendMail(mailOptions);\r\n        }\r\n    } catch (error) {\r\n        console.error('E-posta gönderim hatası:', error);\r\n    }\r\n\r\n    revalidatePath('/admin/messages');\r\n}\r\n\r\nexport async function deleteMessage(id: string) {\r\n    const messages = await db.messages.getAll();\r\n    const filteredMessages = messages.filter(m => m.id !== id);\r\n    await db.messages.updateAll(filteredMessages);\r\n    revalidatePath('/admin/messages');\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AAEA;AACA;AAEA;;;;;;;AAEO,eAAe,YAAY,QAAkB;IAChD,MAAM,WAAW,MAAM,8HAAE,CAAC,QAAQ,CAAC,GAAG;IACtC,MAAM,OAAO,SAAS,GAAG,CAAC;IAC1B,MAAM,QAAQ,SAAS,GAAG,CAAC,YAAsB;IACjD,MAAM,QAAQ,SAAS,GAAG,CAAC,YAAsB;IACjD,MAAM,iBAAiB,SAAS,GAAG,CAAC;IAEpC,IAAI,CAAC,QAAQ,CAAC,gBAAgB;QAC1B,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,aAAsB;QACxB,IAAI,IAAA,iLAAM;QACV;QACA;QACA;QACA,SAAS;QACT,WAAW,IAAI,OAAO,WAAW;QACjC,QAAQ;IACZ;IAEA,MAAM,8HAAE,CAAC,QAAQ,CAAC,GAAG,CAAC;IAEtB,kDAAkD;IAClD,IAAI;QACA,MAAM,cAAc,0JAAU,CAAC,eAAe,CAAC;YAC3C,MAAM,QAAQ,GAAG,CAAC,SAAS;YAC3B,MAAM,OAAO,QAAQ,GAAG,CAAC,SAAS;YAClC,QAAQ,QAAQ,GAAG,CAAC,SAAS,KAAK;YAClC,MAAM;gBACF,MAAM,QAAQ,GAAG,CAAC,SAAS;gBAC3B,MAAM,QAAQ,GAAG,CAAC,SAAS;YAC/B;QACJ;QAEA,MAAM,cAAc;YAChB,MAAM,QAAQ,GAAG,CAAC,SAAS;YAC3B,IAAI,SAAS,OAAO,CAAC,KAAK;YAC1B,SAAS,CAAC,YAAY,EAAE,MAAM;YAC9B,MAAM,CAAC;;;0BAGO,EAAE,KAAK;yBACR,EAAE,MAAM;yBACR,EAAE,MAAM;uBACV,EAAE,eAAe;wBAChB,EAAE,IAAI,OAAO,kBAAkB,CAAC,SAAS;YACrD,CAAC;QACL;QAEA,IAAI,QAAQ,GAAG,CAAC,SAAS,EAAE;YACvB,MAAM,YAAY,QAAQ,CAAC;QAC/B;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,4BAA4B;IAC9C;IAEA,IAAA,+IAAc,EAAC;AACnB;AAEO,eAAe,cAAc,EAAU;IAC1C,MAAM,WAAW,MAAM,8HAAE,CAAC,QAAQ,CAAC,MAAM;IACzC,MAAM,mBAAmB,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IACvD,MAAM,8HAAE,CAAC,QAAQ,CAAC,SAAS,CAAC;IAC5B,IAAA,+IAAc,EAAC;AACnB;;;IAjEsB;IA4DA;;AA5DA,+OAAA;AA4DA,+OAAA"}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/savas/Downloads/agenttest/EylulSanatWeb/.next-internal/server/app/admin/%28dashboard%29/messages/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {logout as '00c40a5fb022569ec23f2a4d238b75af0261bb5ef2'} from 'ACTIONS_MODULE0'\nexport {deleteMessage as '40682ff682ee3bcb67ca95e95c11e07bb6f66518cc'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AACA"}}]
}