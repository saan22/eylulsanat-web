{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/savas/Downloads/agenttest/EylulSanatWeb/src/actions/auth.ts"],"sourcesContent":["'use server';\r\n\r\nimport bcrypt from 'bcryptjs';\r\nimport { createSession, deleteSession } from '@/lib/session';\r\nimport { redirect } from 'next/navigation';\r\nimport { db } from '@/lib/json-db';\r\n\r\nexport async function login(formData: FormData) {\r\n    const password = formData.get('password') as string;\r\n    const settings = await db.settings.get();\r\n    const storedHash = settings.adminPasswordHash || process.env.ADMIN_PASSWORD_HASH;\r\n\r\n    if (!storedHash) {\r\n        throw new Error('Admin password hash is not set');\r\n    }\r\n\r\n    // Development bypass ensures you can login locally easily\r\n    // In production, this block is automatically skipped\r\n    if (process.env.NODE_ENV !== 'production' && password === 'admin123') {\r\n        await createSession();\r\n        redirect('/admin');\r\n    }\r\n\r\n    const isValid = await bcrypt.compare(password, storedHash);\r\n\r\n    if (!isValid) {\r\n        return { error: 'Hatalı şifre.' };\r\n    }\r\n\r\n    await createSession();\r\n    redirect('/admin');\r\n}\r\n\r\nexport async function logout() {\r\n    await deleteSession();\r\n    redirect('/');\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAAA;AACA;;;;;;;AAEO,eAAe,MAAM,QAAkB;IAC1C,MAAM,WAAW,SAAS,GAAG,CAAC;IAC9B,MAAM,WAAW,MAAM,8HAAE,CAAC,QAAQ,CAAC,GAAG;IACtC,MAAM,aAAa,SAAS,iBAAiB,IAAI,QAAQ,GAAG,CAAC,mBAAmB;IAEhF,IAAI,CAAC,YAAY;QACb,MAAM,IAAI,MAAM;IACpB;IAEA,0DAA0D;IAC1D,qDAAqD;IACrD,IAAI,oDAAyB,gBAAgB,aAAa,YAAY;QAClE,MAAM,IAAA,sIAAa;QACnB,IAAA,iMAAQ,EAAC;IACb;IAEA,MAAM,UAAU,MAAM,4IAAM,CAAC,OAAO,CAAC,UAAU;IAE/C,IAAI,CAAC,SAAS;QACV,OAAO;YAAE,OAAO;QAAgB;IACpC;IAEA,MAAM,IAAA,sIAAa;IACnB,IAAA,iMAAQ,EAAC;AACb;AAEO,eAAe;IAClB,MAAM,IAAA,sIAAa;IACnB,IAAA,iMAAQ,EAAC;AACb;;;IA7BsB;IA0BA;;AA1BA,+OAAA;AA0BA,+OAAA"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/savas/Downloads/agenttest/EylulSanatWeb/src/actions/settings.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db } from '@/lib/json-db';\r\nimport { Settings } from '@/types';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nimport bcrypt from 'bcryptjs';\r\n\r\nexport async function updateSettings(formData: FormData) {\r\n    const currentSettings = await db.settings.get();\r\n\r\n    const settings: Settings = {\r\n        siteTitle: formData.get('siteTitle') as string,\r\n        siteDescription: formData.get('siteDescription') as string,\r\n        contact: {\r\n            phone: formData.get('phone') as string,\r\n            email: formData.get('email') as string,\r\n            address: formData.get('address') as string,\r\n            mapUrl: formData.get('mapUrl') as string,\r\n        },\r\n        socials: {\r\n            instagram: formData.get('instagram') as string,\r\n            facebook: formData.get('facebook') as string,\r\n            youtube: formData.get('youtube') as string,\r\n        },\r\n        features: {\r\n            maintenanceMode: formData.get('maintenanceMode') === 'on', // 'on' = açık, 'off' veya null = kapalı\r\n        },\r\n        hero: {\r\n            title: formData.get('heroTitle') as string,\r\n            subtitle: formData.get('heroSubtitle') as string,\r\n            image: formData.get('heroImage') as string,\r\n        },\r\n        about: {\r\n            title: formData.get('aboutTitle') as string,\r\n            description: formData.get('aboutDescription') as string,\r\n            image: formData.get('aboutImage') as string,\r\n        },\r\n        whyUs: {\r\n            title: formData.get('whyUsTitle') as string,\r\n            items: (formData.get('whyUsItems') as string || '').split('\\n').filter(Boolean).map(item => item.trim()),\r\n        },\r\n        logo: formData.get('logo') as string,\r\n        adminPasswordHash: currentSettings.adminPasswordHash // Şifreyi koru\r\n    };\r\n\r\n    await db.settings.update(settings);\r\n    revalidatePath('/', 'layout');\r\n    revalidatePath('/admin/settings');\r\n}\r\n\r\nexport async function updatePassword(formData: FormData) {\r\n    const currentPassword = formData.get('currentPassword') as string;\r\n    const newPassword = formData.get('newPassword') as string;\r\n    const confirmPassword = formData.get('confirmPassword') as string;\r\n\r\n    if (!currentPassword || !newPassword || !confirmPassword) {\r\n        return { error: 'Lütfen tüm alanları doldurun.' };\r\n    }\r\n\r\n    if (newPassword !== confirmPassword) {\r\n        return { error: 'Yeni şifreler eşleşmiyor.' };\r\n    }\r\n\r\n    const settings = await db.settings.get();\r\n    const storedHash = settings.adminPasswordHash || process.env.ADMIN_PASSWORD_HASH;\r\n\r\n    if (!storedHash) {\r\n        return { error: 'Sistem hatası: Şifre kaydı bulunamadı.' };\r\n    }\r\n\r\n    const isValid = await bcrypt.compare(currentPassword, storedHash);\r\n    if (!isValid) {\r\n        return { error: 'Mevcut şifre hatalı.' };\r\n    }\r\n\r\n    const newHash = await bcrypt.hash(newPassword, 10);\r\n\r\n    const updatedSettings = {\r\n        ...settings,\r\n        adminPasswordHash: newHash\r\n    };\r\n\r\n    await db.settings.update(updatedSettings);\r\n    revalidatePath('/admin/settings');\r\n\r\n    return { success: true };\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AAEA;AAEA;;;;;;AAEO,eAAe,eAAe,QAAkB;IACnD,MAAM,kBAAkB,MAAM,8HAAE,CAAC,QAAQ,CAAC,GAAG;IAE7C,MAAM,WAAqB;QACvB,WAAW,SAAS,GAAG,CAAC;QACxB,iBAAiB,SAAS,GAAG,CAAC;QAC9B,SAAS;YACL,OAAO,SAAS,GAAG,CAAC;YACpB,OAAO,SAAS,GAAG,CAAC;YACpB,SAAS,SAAS,GAAG,CAAC;YACtB,QAAQ,SAAS,GAAG,CAAC;QACzB;QACA,SAAS;YACL,WAAW,SAAS,GAAG,CAAC;YACxB,UAAU,SAAS,GAAG,CAAC;YACvB,SAAS,SAAS,GAAG,CAAC;QAC1B;QACA,UAAU;YACN,iBAAiB,SAAS,GAAG,CAAC,uBAAuB;QACzD;QACA,MAAM;YACF,OAAO,SAAS,GAAG,CAAC;YACpB,UAAU,SAAS,GAAG,CAAC;YACvB,OAAO,SAAS,GAAG,CAAC;QACxB;QACA,OAAO;YACH,OAAO,SAAS,GAAG,CAAC;YACpB,aAAa,SAAS,GAAG,CAAC;YAC1B,OAAO,SAAS,GAAG,CAAC;QACxB;QACA,OAAO;YACH,OAAO,SAAS,GAAG,CAAC;YACpB,OAAO,CAAC,SAAS,GAAG,CAAC,iBAA2B,EAAE,EAAE,KAAK,CAAC,MAAM,MAAM,CAAC,SAAS,GAAG,CAAC,CAAA,OAAQ,KAAK,IAAI;QACzG;QACA,MAAM,SAAS,GAAG,CAAC;QACnB,mBAAmB,gBAAgB,iBAAiB,CAAC,eAAe;IACxE;IAEA,MAAM,8HAAE,CAAC,QAAQ,CAAC,MAAM,CAAC;IACzB,IAAA,+IAAc,EAAC,KAAK;IACpB,IAAA,+IAAc,EAAC;AACnB;AAEO,eAAe,eAAe,QAAkB;IACnD,MAAM,kBAAkB,SAAS,GAAG,CAAC;IACrC,MAAM,cAAc,SAAS,GAAG,CAAC;IACjC,MAAM,kBAAkB,SAAS,GAAG,CAAC;IAErC,IAAI,CAAC,mBAAmB,CAAC,eAAe,CAAC,iBAAiB;QACtD,OAAO;YAAE,OAAO;QAAgC;IACpD;IAEA,IAAI,gBAAgB,iBAAiB;QACjC,OAAO;YAAE,OAAO;QAA4B;IAChD;IAEA,MAAM,WAAW,MAAM,8HAAE,CAAC,QAAQ,CAAC,GAAG;IACtC,MAAM,aAAa,SAAS,iBAAiB,IAAI,QAAQ,GAAG,CAAC,mBAAmB;IAEhF,IAAI,CAAC,YAAY;QACb,OAAO;YAAE,OAAO;QAAyC;IAC7D;IAEA,MAAM,UAAU,MAAM,4IAAM,CAAC,OAAO,CAAC,iBAAiB;IACtD,IAAI,CAAC,SAAS;QACV,OAAO;YAAE,OAAO;QAAuB;IAC3C;IAEA,MAAM,UAAU,MAAM,4IAAM,CAAC,IAAI,CAAC,aAAa;IAE/C,MAAM,kBAAkB;QACpB,GAAG,QAAQ;QACX,mBAAmB;IACvB;IAEA,MAAM,8HAAE,CAAC,QAAQ,CAAC,MAAM,CAAC;IACzB,IAAA,+IAAc,EAAC;IAEf,OAAO;QAAE,SAAS;IAAK;AAC3B;;;IA/EsB;IA2CA;;AA3CA,+OAAA;AA2CA,+OAAA"}},
    {"offset": {"line": 175, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/savas/Downloads/agenttest/EylulSanatWeb/src/actions/upload.ts"],"sourcesContent":["'use server';\r\n\r\nimport { writeFile, mkdir } from 'fs/promises';\r\nimport { join } from 'path';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nexport async function uploadImage(formData: FormData) {\r\n    const file = formData.get('file') as File;\r\n    if (!file) {\r\n        throw new Error('Dosya seçilmedi');\r\n    }\r\n\r\n    const bytes = await file.arrayBuffer();\r\n    const buffer = Buffer.from(bytes);\r\n\r\n    // Allow only images\r\n    if (!file.type.startsWith('image/')) {\r\n        throw new Error('Sadece resim dosyaları yüklenebilir');\r\n    }\r\n\r\n    const uniqueSuffix = uuidv4();\r\n    const originalName = file.name.replace(/\\.[^/.]+$/, \"\").replace(/[^a-z0-9]/gi, '_').toLowerCase();\r\n    const ext = file.name.split('.').pop();\r\n    const filename = `${originalName}-${uniqueSuffix}.${ext}`;\r\n\r\n    const uploadDir = join(process.cwd(), 'public', 'uploads');\r\n\r\n    // Ensure directory exists\r\n    try {\r\n        await mkdir(uploadDir, { recursive: true });\r\n    } catch (e) {\r\n        // ignore\r\n    }\r\n\r\n    const filepath = join(uploadDir, filename);\r\n    await writeFile(filepath, buffer);\r\n\r\n    return `/uploads/${filename}`;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;;;;AAEO,eAAe,YAAY,QAAkB;IAChD,MAAM,OAAO,SAAS,GAAG,CAAC;IAC1B,IAAI,CAAC,MAAM;QACP,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,QAAQ,MAAM,KAAK,WAAW;IACpC,MAAM,SAAS,OAAO,IAAI,CAAC;IAE3B,oBAAoB;IACpB,IAAI,CAAC,KAAK,IAAI,CAAC,UAAU,CAAC,WAAW;QACjC,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,eAAe,IAAA,iLAAM;IAC3B,MAAM,eAAe,KAAK,IAAI,CAAC,OAAO,CAAC,aAAa,IAAI,OAAO,CAAC,eAAe,KAAK,WAAW;IAC/F,MAAM,MAAM,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG;IACpC,MAAM,WAAW,GAAG,aAAa,CAAC,EAAE,aAAa,CAAC,EAAE,KAAK;IAEzD,MAAM,YAAY,IAAA,yGAAI,EAAC,QAAQ,GAAG,IAAI,UAAU;IAEhD,0BAA0B;IAC1B,IAAI;QACA,MAAM,IAAA,8HAAK,EAAC,WAAW;YAAE,WAAW;QAAK;IAC7C,EAAE,OAAO,GAAG;IACR,SAAS;IACb;IAEA,MAAM,WAAW,IAAA,yGAAI,EAAC,WAAW;IACjC,MAAM,IAAA,kIAAS,EAAC,UAAU;IAE1B,OAAO,CAAC,SAAS,EAAE,UAAU;AACjC;;;IAhCsB;;AAAA,+OAAA"}},
    {"offset": {"line": 225, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/savas/Downloads/agenttest/EylulSanatWeb/.next-internal/server/app/admin/%28dashboard%29/settings/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {logout as '00c40a5fb022569ec23f2a4d238b75af0261bb5ef2'} from 'ACTIONS_MODULE0'\nexport {updateSettings as '401aa3a4fe58f20c9d83bb029e5fdee8eb9749d368'} from 'ACTIONS_MODULE1'\nexport {updatePassword as '4037b4658adbcba2228620298c225561e30189af45'} from 'ACTIONS_MODULE1'\nexport {uploadImage as '407ffac5d3836a7faf25de44e83239613a39ee2b67'} from 'ACTIONS_MODULE2'\n"],"names":[],"mappings":";AAAA;AACA;AAEA"}}]
}